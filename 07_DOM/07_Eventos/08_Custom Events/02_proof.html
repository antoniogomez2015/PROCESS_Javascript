<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <!--


        Custom Events:
        ______________
        


    -->

    <h1>Creating Events</h1>

    <main>
        <!--add stuff here-->
    </main>


    <script>
    
            
        //1 let evt = new Event('explode');
        //2 let evt = new CustomEvent('explode', {detail:{speed:29, volume:40}});

        let born = new Event('born');
        let died = new CustomEvent('died', {detail: {time:Date.now()}});


        document.addEventListener('DOMContentLoaded', function(){
            let m = document.querySelector('main');
            addParagraph(m, 'This is un paragrapth');
            addParagraph(m, 'A new Star Wars movie is coming soon');

            m.addEventListener('click', function(ev){
                removeParagrapth(m, m.firstElementChild);
            });
            
        });

        function addParagraph(parent, text){
            let p = document.createElement('p');
            p.textContent = text;

            //set up and dispatch events
            p.addEventListener('born', wasBorn);
            p.addEventListener('died', hasDied);
            p.dispatchEvent(born);

            //add to screen
            parent.appendChild(p);
        }
        

        function removeParagrapth(parent, p){

            //dispatch event
            p.dispatchEvent(died);

            //remove elemento from scree
            parent.removeChild(p);
        }

        function wasBorn(ev){
            console.log(ev.type, ev.target);
        }

        function hasDied(ev){
            console.log(ev.type, ev.target, ev.detail.time);

            //remove the listeners
            ev.target.removeEventListener('born', wasBorn);
            ev.target.removeEventListener('died', hasDied);
        }


    </script>

</body>
</html>